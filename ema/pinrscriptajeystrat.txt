// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © AlgoTest
//@version=6

indicator(title='5Ema Indicator', overlay=true)
RiRe = input.int(defval=3, title='Risk to Reward Ratio', minval=2, maxval=25)
ema_length = input.int(5, title='EMA Length')
ema = ta.ema(close, ema_length)
plot(ema, 'EMA', color=color.blue, linewidth=2)

var bool Short = false  // Initialize with a boolean value instead of `na`
var int shortC = 0
var int sslhitC = 0
var int starhitC = 0
var float ssl = na
var float starl = na
var float star = na
var float sellat = na
var float alert_shorthigh = na
var float alert_shortlow = na

if dayofweek != dayofweek[1]
    Short := false  // Reset to a boolean value instead of `na`
    shortC := 0
    sslhitC := 0
    starhitC := 0
    ssl := na
    starl := na
    star := na
    sellat := na
    alert_shorthigh := na
    alert_shortlow := na

Short := low[1] > ema[1] and low[1] > low and shortC == 0
sslhit = high > ssl and shortC > 0 and sslhitC == 0
starhit = low < star and shortC > 0 and starhitC == 0

if Short
    shortC := shortC + 1
    sslhitC := 0
    starhitC := 0
    alert_shorthigh := high[1]
    ssl := high[1]
    starl := (high[1] - low[1]) * RiRe
    star := low[1] - starl
    sellat := low[1]

if not sslhit and not starhit and shortC > 0
    sslhitC := 0
    starhitC := 0
else
    if sslhit
        shortC := 0
        sslhitC := sslhitC + 1
    else
        if low < star and shortC > 0 and starhitC == 0
            shortC := 0
            starhitC := starhitC + 1

plotshape(Short, title='Sell', location=location.abovebar, color=color.teal, style=shape.arrowdown, text='Sell', textcolor=color.teal)
plotshape(sslhit, title='SL Hit', location=location.abovebar, color=color.red, style=shape.arrowdown, text='SL Hit', textcolor=color.red)
plotshape(starhit, title='Target Hit', location=location.belowbar, color=color.green, style=shape.arrowup, text='Target Hit', textcolor=color.green)

alertcondition(Short, "Short Signal", "Short Signal")
alertcondition(sslhit, "Stop-loss hit", "Stop-loss hit")
alertcondition(starhit, "Target hit", "Target hit")